{
  "$schema": "https://raw.githubusercontent.com/AzureAD/microsoft-identity-web/refs/heads/master/JsonSchemas/microsoft-identity-web.json",

  "AzureAd": {
    "Instance": "https://login.microsoftonline.com/",
    "Domain": "[YOUR_DOMAIN]",
    "TenantId": "[YOUR_TENANT_ID]",
    "ClientId": "[YOUR_CLIENT_ID]",
    "CallbackPath": "/signin-oidc",
    "Scope": "openid profile email offline_access",
    "RequiredRole": "MyGiftReg.Access",
    "ClientCredentials": [
      {
        "SourceType": "SignedAssertionFromManagedIdentity",
        "ManagedIdentityClientId": "[YOUR_MANAGED_IDENTITY_CLIENT_ID]",
        "TokenExchangeUrl": "api://AzureADTokenExchange/.default"
      }
    ]
  },
  "ManagedIdentity": {
    "Enabled": true,
    "StorageAccountEndpoint": "[STORAGE_ACCOUNT_NAME].table.core.windows.net",
    "ClientId": "[YOUR_MANAGED_IDENTITY_CLIENT_ID]"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  },
  "AllowedHosts": "*",
  "DetailedErrors": true,
  "Environment": "Production"
}
